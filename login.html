<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Login - Kick Off Scholars</title>
    <link href="https://fonts.googleapis.com/css2?family=League+Spartan:wght@400;700&family=Aileron:wght@400&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
</head>
<body>
<header>
    <nav class="menu2">
        <div class="logo2">
            <img src="logodef.png" alt="Logo de Kick Off Scholars">
        </div>
        <ul class="menu-items2">
            <li><a href="index.html">Inicio</a></li>
            <li><a href="quienes-somos.html">Quiénes Somos</a></li>
            <li><a href="index.html#servicios">Nuestros Servicios</a></li>
            <li><a href="contacto.html">Contacto</a></li>
            <li><a href="login.html" class="active">Log in</a></li>
        </ul>
    </nav>
</header>

<main>
    <section id="portal-clientes" class="portal">
        <h1>Portal de Clientes</h1>
        <div id="form-container">
            <!-- Formulario de Login -->
            <div id="login-form" class="formulario activo">
                <h2>Iniciar Sesión</h2>
                <form id="login">
                    <label for="login-email">Correo Electrónico:</label>
                    <input type="email" id="login-email" placeholder="ejemplo@correo.com" required />
                    <label for="login-password">Contraseña:</label>
                    <input type="password" id="login-password" placeholder="Escribe tu contraseña" required />
                    <button type="submit" class="btn-transicion">Entrar</button>
                </form>
                <p id="login-message"></p>
                <p class="form-switch">
                    ¿No tienes cuenta? <a href="#" onclick="toggleForms('register-form')">Regístrate aquí</a>.
                </p>
                <p><a href="#" onclick="resetPassword()">¿Olvidaste tu contraseña?</a></p>
            </div>

            <!-- Formulario de Registro -->
            <div id="register-form" class="formulario">
                <h2>Registrarse</h2>
                <form id="register">
                    <label for="username">Nombre de Usuario:</label>
                    <input type="text" id="username" placeholder="Escribe tu nombre" required />
                    <label for="register-email">Correo Electrónico:</label>
                    <input type="email" id="register-email" placeholder="ejemplo@correo.com" required />
                    <label for="register-password">Contraseña:</label>
                    <input type="password" id="register-password" placeholder="Crea una contraseña" required />
                    <button type="submit" class="btn-transicion">Registrar</button>
                </form>
                <p id="register-message"></p>
                <p class="form-switch">
                    ¿Ya tienes cuenta? <a href="#" onclick="toggleForms('login-form')">Inicia sesión aquí</a>.
                </p>
            </div>
        </div>
    </section>
</main>

<footer>
    <p>&copy; 2025 Kick Off Scholars - Todos los derechos reservados</p>
</footer>

<script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/9.0.0/firebase-app.js";
    import { getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword, sendPasswordResetEmail } from "https://www.gstatic.com/firebasejs/9.0.0/firebase-auth.js";

    const firebaseConfig = {
        apiKey: "AIzaSyCVwQO4CJKFns0btIZRRch-hkJTpuaFCr0",
        authDomain: "kickoffscholars-88767.firebaseapp.com",
        projectId: "kickoffscholars-88767",
        storageBucket: "kickoffscholars-88767.firebasestorage.app",
        messagingSenderId: "307881292779",
        appId: "1:307881292779:web:5adb5b37acbbbb11a59fae"
    };

    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);

    // Alternar entre formularios
    function toggleForms(formId) {
        document.getElementById("login-form").classList.remove("activo");
        document.getElementById("register-form").classList.remove("activo");
        document.getElementById(formId).classList.add("activo");
    }

    // Iniciar sesión
    document.getElementById("login").addEventListener("submit", async (e) => {
        e.preventDefault();
        const email = document.getElementById("login-email").value.trim();
        const password = document.getElementById("login-password").value.trim();
        const messageEl = document.getElementById("login-message");

        try {
            const userCredential = await signInWithEmailAndPassword(auth, email, password);
            const user = userCredential.user;

            if (user.email === "apor2209@gmail.com") {
                window.location.href = "admin.html";
            } else {
                window.location.href = "portal.html";
            }
        } catch (error) {
            messageEl.textContent = "Error: " + error.message;
        }
    });

    // Registrar usuario
    document.getElementById("register").addEventListener("submit", async (e) => {
        e.preventDefault();
        const email = document.getElementById("register-email").value.trim();
        const password = document.getElementById("register-password").value.trim();
        const username = document.getElementById("username").value.trim();
        const messageEl = document.getElementById("register-message");

        try {
            await createUserWithEmailAndPassword(auth, email, password);
            alert("Usuario registrado exitosamente. Ahora puedes iniciar sesión.");
            toggleForms("login-form");
        } catch (error) {
            messageEl.textContent = "Error: " + error.message;
        }
    });

    // Recuperar contraseña
    function resetPassword() {
        const email = document.getElementById("login-email").value;
        if (email) {
            sendPasswordResetEmail(auth, email)
                .then(() => {
                    alert('Te hemos enviado un enlace para restablecer tu contraseña');
                })
                .catch((error) => {
                    alert(error.message);
                });
        } else {
            alert('Por favor ingresa un correo electrónico');
        }
    }
</script>
</body>
</html>
